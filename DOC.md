# TODO List 项目说明文档

## 1. 技术选型
- **编程语言**：JavaScript，理由：无需配置、生态成熟、快速开发。  
- **框架/库**：Vue3，理由：响应式数据绑定、组件化开发、官方生态成熟。  
- **数据库/存储**：IndexedDB，理由：本地离线存储、容量大、支持复杂查询、索引和事务。  
- 替代方案对比：LocalStorage容量不大，只能存储字符串，每次读写都需要 JSON 序列化、反序列化，性能差且同步操作会阻塞主线程；SQLite需要加载约800KB的WASM文件，在浏览器沙箱中持久化数据需要依赖文件系统 API，增加了复杂度，而 TODO 应用的数据关系非常简单，完全不需要完整的关系型数据库；使用本地文件系统，需要用户每次手动授权API且该 API 兼容性有限。

- ## 2. 项目结构设计
- 整体架构说明:
- **1. 架构类型**
- 本项目采用纯前端架构，数据完全存储在浏览器本地。
- **2.整体架构:**
- 用户界面层[任务列表展示、任务表单]->业务逻辑层[状态管理(任务状态、草稿状态、tab状态、任务数量等)、公共函数、逻辑处理]->数据层[草稿表、任务表]
- 目录结构：
- ```
    src/
      components/
      App.vue
      styles/
      utils/
      indexedDB.js
      main.js
  ```
- **模块职责说明**:
#### **indexedDB.js** - 数据存储，封装 IndexedDB 操作，提供统一的数据接口
核心函数：
- `openDB()` - 初始化数据库，创建 object store
- `withStore(storeName, mode, callback)` - 事务包装器
- CRUD 操作

#### **App.vue** - 主应用组件，进行全局状态管理、事件分发、列表展示控制
核心功能：虚拟列表、按截止时间/优先级/创建时间排序、保存、创建/修改任务、完成/取消完成任务、切换tab获取数据、删除任务、自动保存草稿

#### **TodoDialog.vue** - 编辑对话框组件，待办创建和编辑的输入表单
- 表单验证规则：
  - 标题不能为空或仅空格
  - 期限不能早于当前时间
  - esc清空输入

#### **TodoList.vue** - 列表展示组件，虚拟滚动列表展示、交互反馈
- 按需展示：
  - 已完成任务显示删除线
  - 已过期任务显示红色标题警告
  - 正常任务粗体标题

- 用户功能：
  - 点击条目打开编辑，完成只能查看
  - 右侧按钮快速完成/删除

#### **utils/index.js** - 通用工具函数
函数：
- `showError(err, opts)` - 统一的错误提示
- `throttle(fn, delay)` - 节流函数
- `debounce(fn, delay)` - 防抖函数
- `formatDate(value)` - 日期格式化（YYYY-MM-DD HH:mm）

#### **utils/reminder.js** - 提醒管理，用于到期前十分钟、到期切换状态
核心功能：
- 定时提醒: 在待办事项截止时间前10分钟发送通知提醒用户
- 过期处理: 在待办事项到达截止时间时触发相应的回调处理

#### **styles/common.css** - 全局样式

## 3. 需求细节与决策
- 描述是否必填？如何处理空输入？
    选填，空不做处理，但是标题必填需要当空时弹出提示框提醒，并且required设置为必选项；
- 已完成的任务在 UI 或 CLI 中如何显示？
   使用未完成任务的同一列表呢，只是获取的数据不同，通过tab切换查看获取；
- 任务排序逻辑（默认按创建时间，用户可选按优先级/截止日期）
   创建时间【先创建->后创建】，优先级【高->低】 ，截止日期【即将到期->没那么快到期】
- 如果涉及扩展功能（例如同步/提醒），简述设计思路
   涉及到提醒功能，我是设计的是在任务结束前10分钟提醒用户任务即将过期，所以我将在加载任务数据时进行判断是否任务有截止日期并且截止日期临近现在10分钟内，有则直接提醒，大于10分钟设置定时器提醒，使用Map数据结构管理所有待办事项的定时器；
- 其余细节:对截止日期设置做验证，当大于当前至少一分钟才可以设置，否则弹窗提示；对于已完成任务只能查看不可编辑(readonly)，并且按钮为查看；tab栏切换和滚轮滑动防抖，防止短时间内快速多次进行操作；对不同状态的任务展示样式不同；点击完成可以填写备注；

## 4. AI 使用说明
- 是否使用 AI 工具？有用，Copilot
- 使用 AI 的环节：代码基础框架生成，就是会把基础的功能点，我需要怎么实现给它，让它生成一份初稿，然后我在进行修改优化；
- AI 输出如何修改：初始时我会对需求任务进行拆分，对技术选型，基础组件封装和功能实现要点告知，所以不会出现我需要IndexedDB，它给我其他的；
  - 但会出现一些问题:
  - 1.一些重复函数多次重复书写，代码冗余，我会对它们提取封装为公共工具函数；
  - 2.AI生成代码有问题没能实现功能，或者实现的有问题；如我在初稿时我告诉了他要虚拟列表，但是它生成的是错误的，所以后面我查看代码，修改错误；AI不是动态获取scrollTop和innerHeight，没有注意缓冲区；
  - 3.AI生成了，但是有副作用，如AI的生成结果有3个滚动条,修改格式，对外部的div设置的高度值不设置，由子撑大

## 5. 运行与测试方式
- 本地运行方式（安装依赖、启动命令）。见README.md
- 已测试过的环境 操作系统: Windows 10/11；浏览器:Chrome,Edge
- 已知问题与不足:多任务时定时器很多，难以进行管理，容易造成内存泄漏；仅通过页面是否可见来判断系统休眠，但在某些极端情况下造成的系统休眠或其他可能仍然无法准确触发提醒；定时器来通知影响性能；

- ## 6. 总结与反思
- 如果有更多时间，你会如何改进？
   对当前定时器的风险进行优化，使用时间轮算法或者websocket服务端推送进行解决；
- 你觉得这个实现的最大亮点是什么？  
  1.提醒功能；2.有对任务草稿保存，草稿自动保存功能确保数据不丢失；3.虚拟滚动;4.代码封装；可复用性强;
  
